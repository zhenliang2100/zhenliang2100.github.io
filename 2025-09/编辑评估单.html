<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>编辑评估单 - iPad应用</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <script src="../js/back-button.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1E40AF',
                        secondary: '#3B82F6',
                        success: '#10B981',
                        warning: '#F59E0B',
                        danger: '#EF4444',
                        info: '#6366F1',
                        light: '#F3F4F6',
                        dark: '#1F2937'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .tab-active {
                @apply bg-primary text-white border-b-2 border-primary;
            }
            .tab-inactive {
                @apply bg-gray-100 text-gray-600 border-b-2 border-transparent hover:bg-gray-200;
            }
            .form-label {
                @apply block text-sm font-medium text-gray-700 mb-1;
            }
            .form-input {
                @apply w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200;
            }
            .form-input-readonly {
                @apply w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 bg-gray-100;
            }
            .form-select {
                @apply w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200;
            }
            .form-select-readonly {
                @apply w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 bg-gray-100;
            }
            .form-textarea {
                @apply w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200 resize-y min-h-[100px];
            }
            .form-textarea-readonly {
                @apply w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 bg-gray-100 resize-y min-h-[100px];
            }
            .form-required {
                @apply text-danger;
            }
            .form-button {
                @apply bg-secondary hover:bg-secondary/90 text-white px-3 py-2 rounded-lg transition-colors duration-200;
            }
            .upload-area {
                @apply border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-primary transition-colors duration-200 cursor-pointer;
            }
            .image-preview {
                @apply relative w-full h-40 bg-gray-100 rounded-lg overflow-hidden;
            }
            .image-preview img {
                @apply w-full h-full object-cover;
            }
            .image-remove {
                @apply absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer;
            }
            .status-badge {
                @apply px-3 py-1 rounded-full text-xs font-medium;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">
    <!-- 顶部导航栏 -->
    <header class="bg-white shadow-md fixed top-0 left-0 right-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <button class="text-primary text-xl px-2" id="back-button">
                    <i class="fa fa-arrow-left"></i>
                </button>
                <i class="fa fa-file-text text-primary text-2xl"></i>
                <h1 class="text-xl font-bold text-gray-800">编辑评估单</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors duration-200" id="cancel-button">
                    取消
                </button>
                <button class="bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg transition-colors duration-200" id="submit-button">
                    保存
                </button>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="container mx-auto px-4 pt-28 pb-12">
        <!-- 工单状态 -->
        <div class="bg-white rounded-xl p-4 shadow-md mb-6 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <span class="status-badge bg-yellow-100 text-yellow-800">评估中</span>
                <span class="text-sm font-medium text-gray-600">工单编号: 250730160824930</span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-xs text-gray-500">工单时间: 2025-07-30 16:08:24</span>
            </div>
        </div>

        <!-- 表单步骤Tab -->
        <div class="bg-white rounded-t-xl shadow-md mb-0">
            <div class="flex overflow-x-auto scrollbar-hide border-b border-gray-200">
                <button id="tab-vehicle" class="tab-active whitespace-nowrap px-6 py-3 text-sm font-medium">
                    车辆信息
                </button>
                <button id="tab-document" class="tab-inactive whitespace-nowrap px-6 py-3 text-sm font-medium">
                    牌证信息
                </button>
                <button id="tab-image" class="tab-inactive whitespace-nowrap px-6 py-3 text-sm font-medium">
                    图像信息
                </button>
            </div>
        </div>

        <!-- 表单内容区域 -->
        <div class="bg-white rounded-b-xl shadow-md p-6">
            <!-- 车辆信息表单 -->
            <div id="form-vehicle" class="space-y-6">
                <!-- 行驶证识别按钮 -->
                <div class="mb-6 flex items-center">
                    <button id="ocr-license-button" class="bg-secondary hover:bg-secondary/90 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <i class="fa fa-camera mr-2"></i>
                        拍摄行驶证自动识别
                    </button>
                    <button type="button" class="form-button ml-2" onclick="recognizeVIN()">车架号自动识别</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 销售顾问 -->
                    <div>
                        <label class="form-label">
                            销售顾问
                        </label>
                        <input type="text" class="form-input" value="张三">
                    </div>

                    <!-- 车辆名称 -->
                    <div>
                        <label class="form-label">
                            品牌车型
                        </label>
                        <input type="text" class="form-input" value="奥迪 A6L">
                    </div>

                    <!-- 车架号 -->
                    <div>
                        <label class="form-label">
                            车架号
                        </label>
                        <input type="text" class="form-input" value="LFV3A28K0J3000001">
                    </div>

                    <!-- 车牌号 -->
                    <div>
                        <label class="form-label">
                            车牌号
                        </label>
                        <input type="text" class="form-input" value="粤A12345">
                    </div>

                    <!-- 发动机号 -->
                    <div>
                        <label class="form-label">
                            发动机号
                        </label>
                        <input type="text" class="form-input" value="12345678">
                    </div>

                    <!-- 上牌时间 -->
                    <div>
                        <label class="form-label">
                            上牌时间
                        </label>
                        <input type="date" class="form-input" value="2020-01-01">
                    </div>

                    <!-- 上牌城市 (省市级联) -->
                    <div>
                        <label class="form-label">
                            上牌城市
                        </label>
                        <input type="text" class="form-input" value="广东省-广州市">
                    </div>

                    <!-- 车辆所在地 -->
                    <div>
                        <label class="form-label">
                            车辆所在地
                        </label>
                        <input type="text" class="form-input" value="广东省-广州市">
                    </div>

                    <!-- 表显里程 -->
                    <div>
                        <label class="form-label">
                            表显里程
                        </label>
                        <input type="text" class="form-input" value="50000公里">
                    </div>

                    <!-- 使用性质 -->
                    <div>
                        <label class="form-label">
                            使用性质
                        </label>
                        <select class="form-select">
                            <option value="非营运" selected>非营运</option>
                            <option value="营运">营运</option>
                            <option value="营转非">营转非</option>
                        </select>
                    </div>

                    <!-- 所有人性质 -->
                    <div>
                        <label class="form-label">
                            所有人性质
                        </label>
                        <select class="form-select">
                            <option value="个人" selected>个人</option>
                            <option value="单位">单位</option>
                        </select>
                    </div>

                    <!-- 天窗 -->
                    <div>
                        <label class="form-label">
                            天窗
                        </label>
                        <select class="form-select">
                            <option value="无天窗">无天窗</option>
                            <option value="普通天窗" selected>普通天窗</option>
                            <option value="全景天窗">全景天窗</option>
                        </select>
                    </div>

                    <!-- 车辆类别 -->
                    <div>
                        <label class="form-label">
                            车辆类别
                        </label>
                        <select class="form-select">
                            <option value="置换车" selected>置换车</option>
                            <option value="收购车">收购车</option>
                            <option value="寄售车">寄售车</option>
                        </select>
                    </div>

                    <!-- 排放标准 -->
                    <div>
                        <label class="form-label">
                            排放标准
                        </label>
                        <select class="form-select">
                            <option value="国3">国3</option>
                            <option value="国4">国4</option>
                            <option value="国5">国5</option>
                            <option value="国6" selected>国6</option>
                        </select>
                    </div>

                    <!-- 内饰颜色 -->
                    <div>
                        <label class="form-label">
                            内饰颜色
                        </label>
                        <input type="text" class="form-input" value="黑色">
                    </div>

                    <!-- 外观颜色 -->
                    <div>
                        <label class="form-label">
                            外观颜色
                        </label>
                        <input type="text" class="form-input" value="白色">
                    </div>

                    <!-- 生产日期 -->
                    <div>
                        <label class="form-label">
                            生产日期
                        </label>
                        <input type="date" class="form-input" value="2019-05-01">
                    </div>

                    <!-- 指导价 -->
                    <div>
                        <label class="form-label">
                            指导价
                        </label>
                        <input type="text" class="form-input" value="40万元">
                    </div>

                    <!-- 是否购买新车 -->
                    <div>
                        <label class="form-label">
                            是否购买新车
                        </label>
                        <select class="form-select">
                            <option value="是" selected>是</option>
                            <option value="否">否</option>
                        </select>
                    </div>

                    <!-- 是否事故 -->
                    <div>
                        <label class="form-label">
                            是否事故
                        </label>
                        <select class="form-select">
                            <option value="是">是</option>
                            <option value="否" selected>否</option>
                        </select>
                    </div>

                    <!-- 综合评价 -->
                    <div>
                        <label class="form-label">
                            综合评价
                        </label>
                        <select class="form-select">
                            <option value="优" selected>优</option>
                            <option value="良">良</option>
                            <option value="中">中</option>
                            <option value="差">差</option>
                        </select>
                    </div>
                </div>

                <!-- 车况描述 (多行文本输入框) -->
                <div>
                    <label class="form-label">
                        车况描述
                    </label>
                    <textarea class="form-textarea">车辆外观保持良好，无明显划痕。内饰干净整洁，功能正常。发动机运转平稳，无异响。变速箱换挡顺畅。制动系统工作正常。轮胎磨损正常，胎压合适。车辆保养记录完整。</textarea>
                </div>
            </div>

            <!-- 牌证信息表单 (默认隐藏) -->
            <div id="form-document" class="space-y-6 hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 钥匙数 -->
                    <div>
                        <label class="form-label">
                            钥匙数
                        </label>
                        <input type="number" class="form-input" value="2">
                    </div>

                    <!-- 过户次数 -->
                    <div>
                        <label class="form-label">
                            过户次数
                        </label>
                        <input type="number" class="form-input" value="1">
                    </div>

                    <!-- 交强险到期 -->
                    <div>
                        <label class="form-label">
                            交强险到期
                        </label>
                        <input type="date" class="form-input" value="2026-01-01">
                    </div>

                    <!-- 年审到期 -->
                    <div>
                        <label class="form-label">
                            年审到期
                        </label>
                        <input type="date" class="form-input" value="2026-01-01">
                    </div>

                    <!-- 商业险到期 -->
                    <div>
                        <label class="form-label">
                            商业险到期
                        </label>
                        <input type="date" class="form-input" value="2026-01-01">
                    </div>

                    <!-- 原车主名称 -->
                    <div>
                        <label class="form-label">
                            原车主名称
                        </label>
                        <input type="text" class="form-input" value="李四">
                    </div>

                    <!-- 原车主住址 -->
                    <div>
                        <label class="form-label">
                            原车主住址
                        </label>
                        <input type="text" class="form-input" value="广东省深圳市南山区">
                    </div>

                    <!-- 原车主电话 -->
                    <div>
                        <label class="form-label">
                            原车主电话
                        </label>
                        <input type="text" class="form-input" value="13800138000">
                    </div>
                </div>
            </div>

            <!-- 图像信息表单 (默认隐藏) -->
            <div id="form-image" class="space-y-6 hidden">
                <!-- 车辆图片 -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">车辆图片</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/1071/400/300" alt="正面45°" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">正面45°</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/1072/400/300" alt="右侧面" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">右侧面</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/1073/400/300" alt="正面" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">正面</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/1074/400/300" alt="后面" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">后面</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/1075/400/300" alt="右侧面" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">右侧面</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/1076/400/300" alt="更多" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">更多</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/1077/400/300" alt="铭牌" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">铭牌</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                    </div>
                </div>

                <!-- 证件资料 -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">证件资料</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/20/400/300" alt="行驶证" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">行驶证</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/21/400/300" alt="登记证1" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">登记证1</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/22/400/300" alt="登记证2" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">登记证2</p>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                    </div>
                </div>

                <!-- 车辆视频 -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">车辆视频</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <video src="#" class="absolute inset-0 w-full h-full object-cover rounded-lg" controls></video>
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">发动机工况</p>
                            <input type="file" class="hidden" accept="video/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <video src="#" class="absolute inset-0 w-full h-full object-cover rounded-lg" controls></video>
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <p class="text-xs text-center text-gray-600">车况解说</p>
                            <input type="file" class="hidden" accept="video/*">
                        </div>
                    </div>
                </div>

                <!-- 其他图片 -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">其他图片</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/30/400/300" alt="其他图片1" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/31/400/300" alt="其他图片2" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                        <div class="space-y-2">
                            <div class="upload-area h-40 flex flex-col items-center justify-center relative">
                                <img src="https://picsum.photos/id/32/400/300" alt="其他图片3" class="absolute inset-0 w-full h-full object-cover rounded-lg">
                                <div class="absolute top-1 right-1 bg-danger text-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer">
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <input type="file" class="hidden" accept="image/*">
                        </div>
                    </div>
                </div>

                            

            </div>

        </div>
    </main>

    <script>
        // Tab切换功能
        const tabs = document.querySelectorAll('[id^="tab-"]');
        const forms = document.querySelectorAll('[id^="form-"]');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有tab的active状态
                tabs.forEach(t => t.classList.remove('tab-active'));
                tabs.forEach(t => t.classList.add('tab-inactive'));
                
                // 添加当前tab的active状态
                tab.classList.remove('tab-inactive');
                tab.classList.add('tab-active');
                
                // 隐藏所有表单
                forms.forEach(form => form.classList.add('hidden'));
                
                // 显示对应表单
                const formId = tab.id.replace('tab', 'form');
                document.getElementById(formId).classList.remove('hidden');
            });
        });
        
        // 取消按钮功能
        document.getElementById('cancel-button').addEventListener('click', function() {
            if (confirm('确定要取消编辑并返回吗？')) {
                window.history.back();
            }
        });
        
        // 提交按钮逻辑
            const submitButton = document.getElementById('submit-button');
            submitButton.addEventListener('click', function() {
                // 这里应该实现表单提交逻辑
                alert('表单提交成功');
                // 提交成功后跳转到工单列表页面
                window.location.href = '工单列表.html';
            });
        
        // 图片上传功能
        document.querySelectorAll('.upload-area').forEach(area => {
            area.addEventListener('click', function() {
                const fileInput = this.nextElementSibling;
                fileInput.click();
            });
        });
        
        // 图片删除功能
        document.querySelectorAll('.image-remove').forEach(button => {
            button.addEventListener('click', function(e) {
                e.stopPropagation();
                const uploadArea = this.parentElement;
                uploadArea.remove();
            });
        });
    </script>
</body>
</html>