<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>轻改专家 - 平板接待缺失报备 (小程序版)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#007AFF',
            secondary: '#8E8E93',
            success: '#34C759',
            warning: '#FF9500',
            danger: '#FF3B30',
            light: '#F2F2F7',
            dark: '#1C1C1E'
          },
          fontFamily: {
            'sf': ['-apple-system', 'BlinkMacSystemFont', 'SF Pro Display', 'Segoe UI', 'Roboto', 'sans-serif']
          }
        }
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .iphone-shadow {
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15), 0 10px 20px rgba(0, 0, 0, 0.1);
      }
      .input-iphone {
        background-color: #F2F2F7;
        border: none;
        border-radius: 10px;
        padding: 10px 12px;
        font-size: 14px;
        transition: all 0.2s ease;
      }
      .input-iphone:focus {
        background-color: #E5E5EA;
        outline: none;
      }
      .select-iphone {
        background-color: #F2F2F7;
        border: none;
        border-radius: 10px;
        padding: 10px 12px;
        font-size: 14px;
        transition: all 0.2s ease;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%238E8E93' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
      }
      .select-iphone:focus {
        background-color: #E5E5EA;
        outline: none;
      }
      .btn-iphone {
        background-color: #007AFF;
        color: white;
        border: none;
        border-radius: 12px;
        padding: 12px 16px;
        font-size: 15px;
        font-weight: 600;
        transition: all 0.2s ease;
        flex: 1;
        margin-right: 8px;
      }
      .btn-iphone:hover {
        background-color: #0066CC;
        transform: translateY(-1px);
      }
      .btn-iphone:active {
        transform: translateY(0);
      }
      .btn-cancel {
        background-color: #F2F2F7;
        color: #8E8E93;
        border: 1px solid #E5E5EA;
        border-radius: 12px;
        padding: 12px 16px;
        font-size: 15px;
        font-weight: 600;
        transition: all 0.2s ease;
        flex: 1;
        margin-left: 8px;
      }
      .btn-cancel:hover {
        background-color: #E5E5EA;
        transform: translateY(-1px);
      }
      .btn-cancel:active {
        transform: translateY(0);
      }
      .card-iphone {
        background-color: white;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        padding: 16px;
      }
      .customer-row-iphone {
        background-color: white;
        border-radius: 14px;
        padding: 14px;
        margin-bottom: 10px;
        transition: all 0.2s ease;
        border: 1px solid #E5E5EA;
      }
      .customer-row-iphone:hover {
        border-color: #007AFF;
        box-shadow: 0 6px 25px rgba(0, 122, 255, 0.1);
      }
      .label-iphone {
        font-size: 12px;
        font-weight: 500;
        color: #8E8E93;
        margin-bottom: 4px;
        display: block;
      }
      .nav-bar-shadow {
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }
      .circle-btn {
        width: auto;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: transparent;
        border: none;
        transition: all 0.2s ease;
      }
      .circle-btn:hover {
        background-color: rgba(0, 0, 0, 0.05);
        border: none;
      }
      .stat-item {
        text-align: center;
        padding: 4px;
        background-color: rgba(0, 122, 255, 0.05);
        border-radius: 8px;
      }
      .stat-label {
        font-size: 9px;
        color: #8E8E93;
        margin-bottom: 2px;
      }
      .stat-value {
        font-size: 13px;
        font-weight: 600;
      }
      .calendar-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
      }
      .calendar-nav-btn {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #F2F2F7;
        color: #8E8E93;
        transition: all 0.2s ease;
      }
      .calendar-nav-btn:hover {
        background-color: #E5E5EA;
        color: #007AFF;
      }
      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 6px;
      }
      .calendar-day {
        text-align: center;
        padding: 8px 4px;
        border-radius: 10px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
      }
      .calendar-day-name {
        color: #8E8E93;
        font-size: 10px;
        padding: 4px;
      }
      .calendar-day:not(.disabled):hover {
        background-color: #F2F2F7;
      }
      .calendar-day.active {
        background-color: #007AFF;
        color: white;
      }
      .calendar-day.disabled {
        color: #E5E5EA;
        cursor: not-allowed;
      }
      .calendar-day.today {
        border: 2px solid #007AFF;
        color: #007AFF;
      }
      .calendar-day.saturday {
        color: #FF3B30;
      }
      .calendar-day.saturday.active {
        color: white;
      }
      .unreported-dot {
        position: absolute;
        bottom: 2px;
        right: 50%;
        transform: translateX(50%);
        width: 4px;
        height: 4px;
        background-color: #FF3B30;
        border-radius: 50%;
      }
      .button-group {
        display: flex;
        gap: 10px;
        margin-top: 16px;
      }
    }
  </style>
</head>
<body class="bg-gray-100 font-sf flex justify-center items-center min-h-screen">
  <!-- iPhone模拟容器 -->
  <div class="iphone-container w-[375px] h-[812px] bg-white rounded-[40px] iphone-shadow overflow-hidden relative border-[10px] border-dark">
    <!-- 小程序导航栏（集成状态栏） -->
    <div class="nav-bar bg-white nav-bar-shadow relative z-10">
      <!-- 状态栏 -->
      <div class="status-bar h-[44px] flex justify-between items-center px-[20px] text-dark font-semibold text-sm pt-[14px]">
        <span id="current-time">9:41</span>
        <div class="flex items-center space-x-1">
          <i class="fa fa-signal text-xs"></i>
          <i class="fa fa-wifi text-xs"></i>
          <i class="fa fa-battery-full text-xs"></i>
        </div>
      </div>
      
      <!-- 导航栏内容 -->
      <div class="h-[44px] flex items-center justify-between px-[16px] relative">
        <!-- 返回按钮 -->
        <button onclick="goBack()" class="flex items-center justify-center w-[44px] h-[44px] rounded-full hover:bg-gray-100 transition-colors duration-200 -ml-0.9">
          <i class="fa fa-chevron-left text-dark"></i>
        </button>
        
        <!-- 标题 -->
        <div class="absolute left-1/2 transform -translate-x-1/2 text-center">
          <h1 class="text-lg font-semibold text-dark">平板接待缺失报备</h1>
        </div>
        
        <!-- 右侧功能按钮 - 只保留更多按钮 -->
        <div class="flex items-center">
          <!-- 更多按钮 -->
          <div class="circle-btn">
            <img src="../images/menu.png" alt="菜单" class="h-[30px] w-auto">
          </div>
        </div>
      </div>
    </div>

    <!-- 主要内容区域 -->
    <div class="main-content h-[calc(100%-88px)] overflow-y-auto px-[16px] py-[16px] bg-light">
      <!-- 日历模块 -->
      <div class="card-iphone mb-[16px]">
        <div class="calendar-header">
          <button onclick="previousWeek()" class="calendar-nav-btn">
            <i class="fa fa-chevron-left text-xs"></i>
          </button>
          <h3 class="text-sm font-semibold text-dark" id="calendar-month-label">2025年9月</h3>
          <div class="calendar-nav-btn opacity-0">
            <i class="fa fa-chevron-right text-xs"></i>
          </div>
        </div>
        
        <!-- 星期名称 -->
        <div class="calendar-grid mb-1">
          <div class="calendar-day calendar-day-name">周一</div>
          <div class="calendar-day calendar-day-name">周二</div>
          <div class="calendar-day calendar-day-name">周三</div>
          <div class="calendar-day calendar-day-name">周四</div>
          <div class="calendar-day calendar-day-name">周五</div>
          <div class="calendar-day calendar-day-name text-danger">周六</div>
          <div class="calendar-day calendar-day-name text-danger">周日</div>
        </div>
        
        <!-- 日期网格 -->
        <div class="calendar-grid" id="calendar-days">
          <!-- 日期将通过JavaScript动态生成 -->
        </div>
      </div>

      <!-- 差异提示卡片 - 优化版 -->
      <div class="card-iphone mb-[16px] border-l-4 border-warning">
        <div class="flex items-start">
          <div class="flex-shrink-0 mt-[2px]">
            <i class="fa fa-exclamation-triangle text-warning text-sm"></i>
          </div>
          <div class="ml-[8px] flex-1">
            <h3 class="text-sm font-semibold text-dark mb-[6px]">平板接待缺失提醒</h3>
            
            <!-- 统计数据网格 - 优化版 -->
            <div class="grid grid-cols-4 gap-[4px] mb-[6px]">
              <div class="stat-item">
                <div class="stat-label">售前</div>
                <div class="stat-value text-primary">8</div>
              </div>
              <div class="stat-item">
                <div class="stat-label">售后</div>
                <div class="stat-value text-success">2</div>
              </div>
              <div class="stat-item">
                <div class="stat-label">总触客</div>
                <div class="stat-value text-purple-600">10</div>
              </div>
              <div class="stat-item">
                <div class="stat-label">录音</div>
                <div class="stat-value text-danger">7</div>
              </div>
            </div>
            
            <p class="text-xs font-medium text-warning leading-tight">
              需要为 <span class="text-base font-bold">3</span> 个客户提供缺失原因说明
            </p>
          </div>
        </div>
      </div>

      <!-- 客户报备列表 -->
      <form id="quick-report-form" class="space-y-[10px]">
        <!-- 客户1 -->
        <div class="customer-row-iphone">
          <div class="flex items-center justify-between mb-[10px]">
            <h3 class="font-semibold text-dark text-sm">
              <span class="inline-flex items-center justify-center w-[24px] h-[24px] bg-primary text-white rounded-full text-xs mr-[8px]">1</span>
              客户信息
            </h3>
          </div>
          <div class="grid grid-cols-12 gap-[8px]">
            <!-- 客户姓名 -->
            <div class="col-span-4">
              <label class="label-iphone">客户姓名</label>
              <input type="text" class="input-iphone w-full" placeholder="客户1" value="客户1">
            </div>
            <!-- 差异原因 -->
            <div class="col-span-8">
              <label class="label-iphone">缺失原因 *</label>
              <select class="select-iphone w-full" required>
                <option value="">请选择原因</option>
                <option value="接待记录上传失败">接待记录上传失败</option>
                <option value="平板故障（无法开机，无法更新等）">平板故障</option>
                <option value="客户未到店，线上或电话成交">线上/电话成交</option>
                <option value="误点【完成接待】">误点完成接待</option>
                <option value="客户接待时间短，无记录">接待时间短</option>
                <option value="一次接待多辆车辆">一次接待多车</option>
                <option value="临时支援门店，临时驻店">临时支援门店</option>
                <option value="二次接待顾客，回访成交">二次接待回访</option>
                <option value="门店关系客户/员工，不介入触客">关系客户</option>
                <option value="资源车，不介入触客">资源车</option>
                <option value="线上成交客户">线上成交</option>
                <option value="门店品牌，车型无法匹配">车型不匹配</option>
              </select>
            </div>
          </div>
        </div>

        <!-- 客户2 -->
        <div class="customer-row-iphone">
          <div class="flex items-center justify-between mb-[10px]">
            <h3 class="font-semibold text-dark text-sm">
              <span class="inline-flex items-center justify-center w-[24px] h-[24px] bg-success text-white rounded-full text-xs mr-[8px]">2</span>
              客户信息
            </h3>
          </div>
          <div class="grid grid-cols-12 gap-[8px]">
            <!-- 客户姓名 -->
            <div class="col-span-4">
              <label class="label-iphone">客户姓名</label>
              <input type="text" class="input-iphone w-full" placeholder="客户2" value="客户2">
            </div>
            <!-- 差异原因 -->
            <div class="col-span-8">
              <label class="label-iphone">缺失原因 *</label>
              <select class="select-iphone w-full" required>
                <option value="">请选择原因</option>
                <option value="接待记录上传失败">接待记录上传失败</option>
                <option value="平板故障（无法开机，无法更新等）">平板故障</option>
                <option value="客户未到店，线上或电话成交">线上/电话成交</option>
                <option value="误点【完成接待】">误点完成接待</option>
                <option value="客户接待时间短，无记录">接待时间短</option>
                <option value="一次接待多辆车辆">一次接待多车</option>
              </select>
            </div>
          </div>
        </div>

        <!-- 客户3 -->
        <div class="customer-row-iphone">
          <div class="flex items-center justify-between mb-[10px]">
            <h3 class="font-semibold text-dark text-sm">
              <span class="inline-flex items-center justify-center w-[24px] h-[24px] bg-purple-600 text-white rounded-full text-xs mr-[8px]">3</span>
              客户信息
            </h3>
          </div>
          <div class="grid grid-cols-12 gap-[8px]">
            <!-- 客户姓名 -->
            <div class="col-span-4">
              <label class="label-iphone">客户姓名</label>
              <input type="text" class="input-iphone w-full" placeholder="客户3" value="客户3">
            </div>
            <!-- 差异原因 -->
            <div class="col-span-8">
              <label class="label-iphone">缺失原因 *</label>
              <select class="select-iphone w-full" required>
                <option value="">请选择原因</option>
                <option value="接待记录上传失败">接待记录上传失败</option>
                <option value="平板故障（无法开机，无法更新等）">平板故障</option>
                <option value="客户未到店，线上或电话成交">线上/电话成交</option>
                <option value="误点【完成接待】">误点完成接待</option>
                <option value="客户接待时间短，无记录">接待时间短</option>
                <option value="一次接待多辆车辆">一次接待多车</option>
              </select>
            </div>
          </div>
        </div>

        <!-- 提交按钮区域 - 左右分开放置 -->
        <div class="button-group">
          <button type="button" onclick="submitQuickReport()" class="btn-iphone">
            <i class="fa fa-check mr-[6px]"></i>提交报备
          </button>
          <button type="button" onclick="showAbandonModal()" class="btn-cancel">
            <i class="fa fa-times mr-[6px]"></i>放弃报备
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- 成功提示弹窗 -->
  <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
    <div class="bg-white rounded-[16px] p-[20px] max-w-[280px] w-full text-center">
      <div class="inline-flex items-center justify-center w-[50px] h-[50px] bg-success/20 rounded-full mb-[12px]">
        <i class="fa fa-check text-success text-xl"></i>
      </div>
      <h3 class="text-base font-semibold text-dark mb-[6px]">操作成功</h3>
      <p class="text-secondary text-xs mb-[16px]" id="success-message">报备提交成功！</p>
      <button onclick="closeSuccessModal()" class="btn-iphone w-full py-[12px] text-sm">
        确定
      </button>
    </div>
  </div>

  <!-- 放弃报备确认弹窗 -->
  <div id="abandon-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
    <div class="bg-white rounded-[16px] p-[20px] max-w-[280px] w-full">
      <div class="text-center mb-[16px]">
        <div class="inline-flex items-center justify-center w-[40px] h-[40px] bg-warning/20 rounded-full mb-[10px]">
          <i class="fa fa-exclamation-triangle text-warning"></i>
        </div>
        <h3 class="text-base font-semibold text-dark mb-[6px]">确认放弃？</h3>
        <p class="text-xs text-dark leading-relaxed">
          接待录音缺失将影响工资绩效，请尽快报备
        </p>
      </div>
      <div class="flex space-x-[8px]">
        <button onclick="closeAbandonModal()" class="flex-1 btn-cancel py-[12px] text-sm">
          取消
        </button>
        <button onclick="confirmAbandon()" class="flex-1 btn-iphone py-[12px] text-sm">
          确定
        </button>
      </div>
    </div>
  </div>

  <script>
    // 日历功能实现
    let currentDate = new Date();
    let selectedDate = new Date();

    // 获取当前周的周一
    function getMonday(d) {
      d = new Date(d);
      const day = d.getDay();
      const diff = d.getDate() - day + (day === 0 ? -6 : 1); // 周日的话需要特殊处理
      return new Date(d.setDate(diff));
    }

    // 格式化日期显示
    function formatDate(date) {
      return date.getDate();
    }

    // 格式化月份显示（去掉周数）
    function formatMonth(date) {
      const year = date.getFullYear();
      const month = date.getMonth() + 1;
      return `${year}年${month}月`;
    }

    // 检查是否是未报备日期（9月30日）
    function isUnreportedDate(date) {
      // 这里可以根据实际数据判断哪些日期未报备
      // 现在硬编码9月30日作为示例
      return date.getFullYear() === 2025 && date.getMonth() === 8 && date.getDate() === 30;
    }

    // 渲染日历
    function renderCalendar() {
      const monday = getMonday(currentDate);
      const calendarDays = document.getElementById('calendar-days');
      const calendarMonthLabel = document.getElementById('calendar-month-label');
      
      // 更新月份标签（去掉周数）
      calendarMonthLabel.textContent = formatMonth(monday);
      
      // 清空日历
      calendarDays.innerHTML = '';
      
      // 生成一周的日期
      for (let i = 0; i < 7; i++) {
        const date = new Date(monday);
        date.setDate(monday.getDate() + i);
        
        const dayElement = document.createElement('div');
        dayElement.className = 'calendar-day';
        
        // 添加星期几的类（周六、周日）
        const dayOfWeek = date.getDay();
        if (dayOfWeek === 6) { // 周六
          dayElement.classList.add('saturday');
        } else if (dayOfWeek === 0) { // 周日
          dayElement.classList.add('sunday');
        }
        
        // 添加日期数字
        dayElement.textContent = formatDate(date);
        
        // 添加星期几的属性
        const weekday = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'][date.getDay()];
        dayElement.title = weekday;
        
        // 检查是否是今天
        const today = new Date();
        if (date.toDateString() === today.toDateString()) {
          dayElement.classList.add('today');
        }
        
        // 检查是否是选中日期
        if (date.toDateString() === selectedDate.toDateString()) {
          dayElement.classList.add('active');
        }
        
        // 检查是否是未报备日期（添加小红点）
        if (isUnreportedDate(date)) {
          const dot = document.createElement('div');
          dot.className = 'unreported-dot';
          dayElement.appendChild(dot);
        }
        
        // 检查是否是未来日期（禁用）
        if (date > today) {
          dayElement.classList.add('disabled');
        } else {
          // 添加点击事件
          dayElement.addEventListener('click', () => {
            selectedDate = new Date(date);
            renderCalendar();
            // 这里可以添加加载数据的逻辑
            loadDataForDate(selectedDate);
          });
        }
        
        calendarDays.appendChild(dayElement);
      }
    }

    // 上一周
    function previousWeek() {
      currentDate.setDate(currentDate.getDate() - 7);
      renderCalendar();
      // 这里可以添加加载数据的逻辑
      loadDataForDate(selectedDate);
    }

    // 为指定日期加载数据
    function loadDataForDate(date) {
      // 模拟加载数据
      const dateStr = date.toLocaleDateString('zh-CN');
      
      // 这里可以根据日期从服务器获取实际数据
      console.log(`加载 ${dateStr} 的数据...`);
      
      // 显示加载提示
      const loadingDiv = document.createElement('div');
      loadingDiv.className = 'fixed top-[100px] left-1/2 transform -translate-x-1/2 bg-dark text-white px-[16px] py-[10px] rounded-[16px] text-xs font-medium z-50';
      loadingDiv.textContent = `正在加载 ${dateStr} 的数据...`;
      document.body.appendChild(loadingDiv);
      
      setTimeout(() => {
        loadingDiv.remove();
        // 这里可以更新页面上的数据显示
      }, 1000);
    }

    // 更新当前时间
    function updateTime() {
      const now = new Date();
      let hours = now.getHours();
      let minutes = now.getMinutes();
      
      // 格式化时间
      const timeString = `${hours}:${minutes.toString().padStart(2, '0')}`;
      document.getElementById('current-time').textContent = timeString;
    }

    // 每秒更新时间
    setInterval(updateTime, 1000);
    updateTime(); // 初始更新

    // 提交快速报备
    function submitQuickReport() {
      const form = document.getElementById('quick-report-form');
      const selects = form.querySelectorAll('select[required]');
      let isValid = true;
      
      // 验证所有必填项
      selects.forEach((select, index) => {
        if (!select.value) {
          isValid = false;
          // 高亮显示未选择的下拉框
          select.style.backgroundColor = '#FFEBE6';
          select.style.border = '1px solid #FF3B30';
          
          // 滚动到第一个未填写的位置
          if (index === 0) {
            select.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
        } else {
          select.style.backgroundColor = '';
          select.style.border = '';
        }
      });
      
      if (!isValid) {
        // iPhone风格的提示
        const alertDiv = document.createElement('div');
        alertDiv.className = 'fixed top-[100px] left-1/2 transform -translate-x-1/2 bg-dark text-white px-[16px] py-[10px] rounded-[16px] text-xs font-medium z-50';
        alertDiv.textContent = '请为所有客户选择缺失原因';
        document.body.appendChild(alertDiv);
        
        setTimeout(() => {
          alertDiv.remove();
        }, 2000);
        return;
      }
      
      // 模拟提交
      setTimeout(() => {
        showSuccessModal('报备提交成功！已通知运营团队审核');
        
        // 重置表单
        selects.forEach(select => {
          select.value = '';
        });
      }, 1000);
    }

    // 返回日报页面（小程序风格）
    function goBack() {
      // 模拟小程序的页面切换动画
      const container = document.querySelector('.main-content');
      container.style.transform = 'translateX(-100%)';
      container.style.transition = 'transform 0.3s ease-out';
      
      setTimeout(() => {
        // 模拟返回成功
        const successDiv = document.createElement('div');
        successDiv.className = 'fixed top-[100px] left-1/2 transform -translate-x-1/2 bg-success text-white px-[16px] py-[10px] rounded-[16px] text-xs font-medium z-50';
        successDiv.textContent = '已返回日报页面';
        document.body.appendChild(successDiv);
        
        // 恢复原位
        container.style.transform = 'translateX(0)';
        
        setTimeout(() => {
          successDiv.remove();
        }, 2000);
      }, 300);
    }

    // 显示成功提示
    function showSuccessModal(message) {
      document.getElementById('success-message').textContent = message;
      document.getElementById('success-modal').classList.remove('hidden');
      document.getElementById('success-modal').classList.add('flex');
    }

    // 关闭成功提示
    function closeSuccessModal() {
      document.getElementById('success-modal').classList.add('hidden');
      document.getElementById('success-modal').classList.remove('flex');
    }

    // 显示放弃报备确认弹窗
    function showAbandonModal() {
      document.getElementById('abandon-modal').classList.remove('hidden');
      document.getElementById('abandon-modal').classList.add('flex');
    }

    // 关闭放弃报备确认弹窗
    function closeAbandonModal() {
      document.getElementById('abandon-modal').classList.add('hidden');
      document.getElementById('abandon-modal').classList.remove('flex');
    }

    // 确认放弃报备
    function confirmAbandon() {
      closeAbandonModal();
      
      // 模拟返回日报页面
      goBack();
    }

    // 点击弹窗外部关闭
    document.getElementById('success-modal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeSuccessModal();
      }
    });

    document.getElementById('abandon-modal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeAbandonModal();
      }
    });

    // 页面加载完成后的初始化
    document.addEventListener('DOMContentLoaded', function() {
      // 初始化日历
      renderCalendar();
      
      // 添加页面加载动画
      const cards = document.querySelectorAll('.customer-row-iphone');
      cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(15px)';
        setTimeout(() => {
          card.style.transition = 'all 0.5s ease';
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 80);
      });

      // 为输入框添加iPhone风格的交互
      const inputs = document.querySelectorAll('.input-iphone, .select-iphone');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.style.transform = 'scale(1.01)';
        });
        
        input.addEventListener('blur', function() {
          this.style.transform = 'scale(1)';
        });
      });

      // 为圆形按钮添加交互
      const circleBtns = document.querySelectorAll('.circle-btn');
      circleBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          this.style.transform = 'scale(0.9)';
          setTimeout(() => {
            this.style.transform = 'scale(1)';
          }, 150);
        });
      });
    });
  </script>
</body>
</html>